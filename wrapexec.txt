12345678901234567890123456789012345678901234567890123456789012345678901234567890

		実行ファイルのラッパー「wrapexec」

                                                 by おぱ (opa)

・概要

	wrapexecは、他のプログラムを単に起動するだけのプログラムです。
	どのプログラムをどのように起動するかを、設定ファイルにより定義
	できます。


・このプログラムが役に立つケースの例

	例えば Perl で有用なツールを作ったとします。そのスクリプトを実行
	しようとするたびに毎回「perl useful_script.pl 云々・・・」と打つのは
	面倒です。
	そこで、wrapexec.exe を useful_script.exe という名前でコピーして
	設定ファイルを記述してやると、単に「useful_script 云々・・・」と打つ
	だけでスクリプトを実行することができます。

	また、スクリプトをプログラムのように扱う手法として、スクリプトの冒頭に
	特別な記述を挿入し、バッチファイルにしてしまうというテクニックも
	よく用いられます。しかしこの場合、要するにバッチファイルですから、
	それを他のバッチファイルから呼ぶときは、意識して「call useful_script」
	などと記述しないと、戻ってきてくれません。
	(MS-DOS時代から連綿と続く、おそるべき仕様)
	このような問題も、wrapexec を介して useful_script.bat を呼ぶように
	すれば解決します。wrapexec は通常のexeファイルですので、バッチファイル
	から起動された場合でも、(当然のことながら)コマンド実行後は元のバッチ
	ファイルに制御が戻ります。

	CUIに慣れている人は、Program Files 以下にインストールされたエディタや
	ツール類を、コマンドラインから起動したいと思うことが多々あると思い
	ます。ところが Program Files 以下には通常PATHは通っていません。
	そもそも Program Files 以下はソフトウェアごとにディレクトリが切られ
	ますので、それらひとつひとつにPATHを通していては大変なことになって
	しまいます。
	このような場合は、どこかパスの通ったディレクトリに warpexec.exe を
	(word.exe でも access.exe でも適当な名前で)コピーして、そこから
	Program Files 以下の本物のプログラムを実行するようにすることで、
	あたかもそのプログラムだけ追加でPATHを通したかのようなことができます。

	実行したいコマンドが、/bin にあるのか、/usr/bin にあるのか、それとも
	/usr/local/bin はたまた /opt/theSoftware/bin にあるのか といった
	問題は Windows では比較的発生しにくいのですが、それでも環境や運用方法
	によっては、実行したいコマンドの実体がどこにあるのかが特定できない
	場合があります。例えば、実行する環境によって、perl.exe や cc.exe の
	場所が異なる場合など。
	wrapexec は、実行するプログラムの候補を複数指定できますので、
	考えられる場所をあらかじめ列挙しておくことで、それらのうちのどこかに
	あればそれを実行するということができます。

	あるプログラムを実行するとき、必ずそれに先立って初期化処理を行いたい
	というケースがあるかと思います。例えば、常に同じ設定で起動するために、
	レジストリをクリアしておきたいなど。
	wrapexec は、複数のプログラムを実行できます。本体のプログラムを起動
	する前に、任意のバッチファイルやスクリプトを実行して、思う存分
	お膳立てをすることができます。

	このように、かように単純なプログラムでも、ことWindowsでCMD.EXEを
	使っている場合はけっこう役に立ちます。


・用途

	exeファイルに対するラッパとして働きます。・・・

	batファイルに対するラッパとして働きます。・・・

	なお、デフォルトの状態では、環境変数 PATHEXT= において .exe が .bat
	よりも先に記述されているため、同じ名前のバッチファイルが存在したと
	しても、exe の方が実行されます。
	(明示的に拡張子を指定した場合を除く)

	その他のスクリプトに対するラッパとして働きます。・・・








	これらの結果として、コマンドプロンプトがCUIのランチャになります。
	パスの通ったディレクトリに例えば

・欠点

	メモリを食います

	環境変数を操作するバッチの場合、



・動作環境

	WindowsNT 4.0以降 (2000/XP/Vista等)

	動作確認はWindowsXP上で行っています。


・使用法


・設定ファイル(.ini)

	実行ファイルの拡張子を .ini に変えたファイルを設定ファイルとして
	読み込みます。

	なお、このファイルはUNICODEのUTF-8で作成する必要があります。


	[option] セクション


	[exec] セクション


	[multi] セクション

	[eof] セクション


'#' または ';' で始まる行はコメントです。
行中の '#' ';' はコメントの開始文字としては扱われないことに注意して下さい。つまり:

# この行はコメントです。
  ;  行頭のスペースは無視されるので、この行もコメントです。
gui = true # これはコメントとは解釈されません。



・オプション

	help
	arg
	chdir
	import_env
	export_env
	verbose
	internal_cmd
	gui
	maximize
	minimize



・実行例


・使用上の注意


・バグ


・今後の課題


・謝辞

	記載の社名、製品名は各社の商標または登録商標です。

	このプログラムは、Borland C++でコンパイルされています。

	このプログラムは、UPXで圧縮されています。


・権利

	同梱の XXXXX を参照してください。




	著作権は作者が保留します。
	作者は、このプログラムのいかなるバグにも修正の義務を負いません。
	また、このプログラム及びドキュメントによって直接的／間接的に起きた
	いかなる事象にも一切の責任を負いません。

	非営利の使用、複写、及び配布は自由、無償です。但しアーカイブを変更
	して再配布することを厳禁します。

#	販売する場合、あるいは書籍／雑誌等に同梱する場合、事前に作者の承諾を
#	必要とします。詳しくはメールでご相談下さい。

#	転載する時は事前に作者の許可を得て下さい。特に理由がない限り、すぐ
#	OK出しますので。

	サポートは http://** で行います。


・変更履歴

	・新規作成。(2009/05/12 version 0.01)


Thank you.
                                            制作・著作

                                                   wrapexec@ken16.net

                                                     おぱ (opa)

