#このファイルは削除しないで下さい。

#HISTORY "wrapexec.cpp"

--2009/08/05以前に済

・かっこいいアイコン
・rcodeの整理
・アイコンが汚い & ボタンのハイライトが薄い & 内側のウィンドウもっと内側に & 高さがなんだか低い & 48x48アイコンはこの際不要?
・svnで管理
・実行するコマンド等に & | 等を含んでいた場合の対応をした(^でエスケープ)
・${xxx} だけでなく $(xxx) $[xxx] も記述可能にした
・パスの末尾には原則 '\'をつけるようにした
・${ARGV_ALL} → ${ARG}
・${SYS_*}
・${USER_*}
・${PROGRAM_*}
・オプション wait
・';'もコメント開始文字として扱う
・環境変数の扱い import_env
・環境変数の扱い export_env
・環境変数からではなく、APIから各種フォルダを取得する SHGetSpecialFolderLocation他
・ユーザ名をAPIから取得する
・コンピュータ名をAPIから取得する
・[EOF]の処理
・c++のwcout,wcerrをやめてcのstdout,stderrを使うようにした
・ifstreamをやめてfopen()をつかうようにした
・複数コマンドの実行に対応
・ドキュメント作成
・サンプルの.iniファイル作成
・タイトル画像
・公開
・xxxList → xxxs

--2009/08/05以前に没

・#!とリネームすると何か動きが変わる機能
→よく考えたら動きが異なる。バッチの管理領域を操作できないと無理
・自分自身をexecしないようガード(wrapexec_singleton_%0)
→複数起動できなくなってしまう
　→CreateProcess()化して起動中のみsingleton化する?
　　→短時間に同時に起動された場合に誤判定してしまう
・バージョン番号が.rcと.cppとに分散している
→分散しててもたいした手間ではない
・${xx\}xx} などという記述は可能にする必要あるか?
→必要になると思われるケースがいまのところない
→${xxx:yyy=zzz}のような記述ができるようになれば必要かも
・import_env=* , export_env=*
→よく考えたらニーズなさそう
・インライン関数を減らすとサイズ減る?
→なぜか全然変わりませんでした・・・
・ファイル存在チェックをAPIで GetFileAttributes()
→何の意味が。

--2009/08/06

● ログ開始



--TODO

・オプション fall_thru (名称未定)
・アイコンとスクリプトをexeに取り込むツール
・ボリュームラベルまたはボリュームシリアルからドライブ名を得る
→http://hp.vector.co.jp/authors/VA007799/tips/tips1.htm Tips1 有効なドライブの情報取得
→GetVolumeInformation よりも SHGetFileInfo をつかう
・カスタムエラーメッセージ
・*wはメッセージは標準出力ではなくMessageBoxで出す
・オプション which
・標準出力を引き継ぐ
・*wのときはcmd.exeをハイドする
・自分自身は再実行しない(PathCanonicalize)


--------
WAIT = off
	プログラムの終了を待たない
WAIT = on
	プログラムの終了を待つ




--------
INTERNAL = off
	実行対象の存在確認をする
	cmd.exe経由で実行する ※ 現状 直接実行する
INTERNAL = on
	実行対象の存在確認をしない
	cmd.exe経由で実行する

--------
CHDIR != UNC PATH
	直接実行する

CHDIR == UNC PATH
	cmd.exe経由で実行する

--------
HIDE = off
	コンソールウィンドウを生成しない
HIDE = on
	コンソールウィンドウを生成する



--------
エクスプローラからダブルクリック(親コンソールなし)
	→GUI=offの場合
		コンソールを開く
		メッセージは標準出力へ
	→GUI=onの場合
		コンソールを開かない
		メッセージはMessageBoxへ

コンソールから実行(親コンソールあり)
	→GUI=offの場合
		親コンソールを再利用
		メッセージは標準出力へ
	→GUI=onの場合
		親コンソールを再利用(ていうか使用しない)
		メッセージはMessageBoxへ

	→GUI=offの場合
		デフォルトで wait = on (終了を待つ)
	→GUI=onの場合
		デフォルトで wait = on (終了を待つ) ※ 現状 off (待たない)




これにより、rogueがインストールされていれば、それを起動して終了する。さもなくば、
hackがインストールされていれば、それを起動して終了する。それも無ければ、emacsの
ハノイの塔を起動して終了する。それすら無ければ、仕方ないのでメッセージを
表示して終了する。といったことができます。

